{"version":3,"sources":["webpack:///./frontend/src/lib/components/Property.js","webpack:///./frontend/src/scenes/events/eventsTableLogic.js","webpack:///./frontend/src/lib/components/FilterPropertyLink.js","webpack:///./frontend/src/scenes/events/EventElements.js","webpack:///./frontend/src/scenes/events/EventDetails.js","webpack:///./frontend/src/scenes/events/EventRow.js","webpack:///./frontend/src/scenes/events/NoItems.js","webpack:///./frontend/src/scenes/events/EventsTable.js","webpack:///./frontend/src/scenes/users/Person.js"],"names":["Property","value","JSON","stringify","replace","eventsTableLogic","kea","key","props","fixedFilters","apiUrl","live","actions","setProperties","properties","updateProperty","fetchEvents","nextParams","fetchEventsSuccess","events","hasNext","isNext","fetchNextEvents","flipSort","pollEvents","pollEventsSuccess","prependNewEvents","setSelectedEvent","selectedEvent","setPollTimeout","pollTimeout","setDelayedLoading","reducers","initialPathname","state","router","selectors","location","pathname","noop","a","_","isLoading","isLoadingNext","orderBy","newEvents","highlightEvents","forEach","event","id","propertiesForUrl","Object","keys","length","values","afterMount","beforeUnmount","clearTimeout","actionToUrl","urlToAction","searchParams","error","objectsEqual","listeners","timestamp","breakpoint","urlParams","toParams","api","get","results","next","setTimeout","params","after","FilterPropertyLink","property","filters","onClick","url","combineUrl","window","to","propTypes","PropTypes","string","isRequired","object","func","indent","n","Array","fill","map","i","EventElements","elements","reverse","element","index","className","style","margin","padding","borderRadius","backgroundColor","tag_name","attr_id","entries","attributes","text","slice","EventDetails","useState","selected","setSelected","role","aria-orientation","maxWidth","overflow","PropertiesTable","Timestamp","moment","toISOString","EventRow","search","filtersEnabled","showLinkToPerson","$event_type","eventNameMap","marginBottom","display","Link","encodeURIComponent","distinct_id","person","paramRequest","param","title","fromNow","NoItems","colSpan","EventsTable","logic","useValues","useActions","person_id","PropertyFilters","pageKey","position","asOverlay","Fragment","isSame","format","setFilter","visibility","textAlign","marginTop","Person","distinctId","setPerson","useEffect","then","danger","deletePersonData","history","push","name","distinct_ids"],"mappings":"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","file":"person.js","sourcesContent":["import React from 'react'\n\nexport function Property({ value }) {\n    return <>{typeof value === 'object' ? JSON.stringify(value) : value && value.replace(/(^\\w+:|^)\\/\\//, '')}</>\n}\n","import { kea } from 'kea'\nimport { objectsEqual, toParams } from 'lib/utils'\nimport { router } from 'kea-router'\nimport api from 'lib/api'\n\nconst POLL_TIMEOUT = 5000\n\n// props:\n// - fixedFilters\n// - apiUrl = 'api/event/'\n// - live = false\nexport const eventsTableLogic = kea({\n    // Set a unique key based on the fixed filters.\n    // This way if we move back/forward between /events and /person/ID, the logic is reloaded.\n    key: props =>\n        (props.fixedFilters ? JSON.stringify(props.fixedFilters) : 'all') +\n        '-' +\n        (props.apiUrl || 'events') +\n        (props.live ? '-live' : ''),\n\n    actions: () => ({\n        setProperties: properties => ({ properties }),\n        updateProperty: (key, value) => ({ key, value }),\n        fetchEvents: (nextParams = null) => ({ nextParams }),\n        fetchEventsSuccess: (events, hasNext = false, isNext = false) => ({ events, hasNext, isNext }),\n        fetchNextEvents: true,\n        flipSort: true,\n        pollEvents: true,\n        pollEventsSuccess: events => ({ events }),\n        prependNewEvents: events => ({ events }),\n        setSelectedEvent: selectedEvent => ({ selectedEvent }),\n        setPollTimeout: pollTimeout => ({ pollTimeout }),\n        setDelayedLoading: true,\n    }),\n\n    reducers: () => ({\n        // save the pathname that was used when this logic was mounted\n        // we use it to NOT update the filters when the user moves away from this path, yet the scene is still active\n        initialPathname: [state => router.selectors.location(state).pathname, { noop: a => a }],\n        properties: [\n            {},\n            {\n                setProperties: (_, { properties }) => properties,\n                updateProperty: (state, { key, value }) => ({ ...state, [key]: value }),\n            },\n        ],\n        isLoading: [\n            false,\n            {\n                fetchEvents: (state, { nextParams }) => (nextParams ? state : state || null),\n                setDelayedLoading: () => true,\n                fetchEventsSuccess: () => false,\n            },\n        ],\n        isLoadingNext: [\n            false,\n            {\n                fetchNextEvents: () => true,\n                fetchEventsSuccess: () => false,\n            },\n        ],\n        events: [\n            [],\n            {\n                fetchEventsSuccess: (state, { events, isNext }) => (isNext ? [...state, ...events] : events),\n                prependNewEvents: (state, { events }) => [...events, ...state],\n            },\n        ],\n        hasNext: [\n            false,\n            {\n                fetchEvents: () => false,\n                fetchNextEvents: () => false,\n                fetchEventsSuccess: (_, { hasNext }) => hasNext,\n            },\n        ],\n        orderBy: ['-timestamp', { flipSort: state => (state === 'timestamp' ? '-timestamp' : 'timestamp') }],\n        selectedEvent: [\n            null,\n            {\n                setSelectedEvent: (_, { selectedEvent }) => selectedEvent,\n            },\n        ],\n        newEvents: [\n            [],\n            {\n                pollEventsSuccess: (_, { events }) => events,\n                prependNewEvents: () => [],\n            },\n        ],\n        highlightEvents: [\n            {},\n            {\n                pollEventsSuccess: () => ({}),\n                prependNewEvents: (_, { events }) => {\n                    const highlightEvents = {}\n                    events.forEach(event => {\n                        highlightEvents[event.id] = true\n                    })\n                    return highlightEvents\n                },\n            },\n        ],\n        pollTimeout: [\n            null,\n            {\n                setPollTimeout: (_, { pollTimeout }) => pollTimeout,\n            },\n        ],\n    }),\n\n    selectors: ({ selectors }) => ({\n        propertiesForUrl: [\n            () => [selectors.properties],\n            properties => {\n                if (Object.keys(properties).length > 0) {\n                    return { properties }\n                } else {\n                    return ''\n                }\n            },\n        ],\n    }),\n\n    events: ({ actions, values }) => ({\n        afterMount: [actions.fetchEvents],\n        beforeUnmount: () => {\n            clearTimeout(values.pollTimeout)\n        },\n    }),\n\n    actionToUrl: ({ values }) => ({\n        setProperties: () => {\n            return [router.values.location.pathname, values.propertiesForUrl]\n        },\n        updateProperty: () => {\n            return [router.values.location.pathname, values.propertiesForUrl]\n        },\n    }),\n\n    urlToAction: ({ actions, values }) => ({\n        '*': (_, searchParams) => {\n            try {\n                // if the url changed, but we are not anymore on the page we were at when the logic was mounted\n                if (router.values.location.pathname !== values.initialPathname) {\n                    return\n                }\n            } catch (error) {\n                // since this is a catch-all route, this code might run during or after the logic was unmounted\n                // if we have an error accessing the filter value, the logic is gone and we should return\n                return\n            }\n\n            if (!objectsEqual(searchParams.properties || {}, values.properties)) {\n                actions.setProperties(searchParams.properties || {})\n            }\n        },\n    }),\n\n    listeners: ({ actions, values, props }) => ({\n        setProperties: () => {\n            actions.fetchEvents()\n        },\n        updateProperty: () => {\n            actions.fetchEvents()\n        },\n        flipSort: () => {\n            actions.fetchEvents()\n        },\n        fetchNextEvents: async () => {\n            const { events, orderBy } = values\n\n            actions.fetchEvents({\n                [orderBy === 'timestamp' ? 'after' : 'before']: events[events.length - 1].timestamp,\n            })\n        },\n        fetchEvents: [\n            async (_, breakpoint) => {\n                if (values.events.length > 0) {\n                    await breakpoint(500)\n                }\n                if (values.isLoading === null) {\n                    actions.setDelayedLoading()\n                }\n            },\n            async ({ nextParams }, breakpoint) => {\n                clearTimeout(values.pollTimeout)\n\n                const urlParams = toParams({\n                    properties: values.properties,\n                    ...(props.fixedFilters || {}),\n                    ...(nextParams || {}),\n                    orderBy: [values.orderBy],\n                })\n\n                const events = await api.get(`${props.apiUrl || 'api/event/'}?${urlParams}`)\n                breakpoint()\n                actions.fetchEventsSuccess(events.results, events.next, !!nextParams)\n\n                actions.setPollTimeout(setTimeout(actions.pollEvents, POLL_TIMEOUT))\n            },\n        ],\n        pollEvents: async (_, breakpoint) => {\n            // Poll events when they are ordered in ascending order based on timestamp\n            if (values.orderBy !== '-timestamp') {\n                return\n            }\n\n            let params = {\n                properties: values.properties,\n                ...(props.fixedFilters || {}),\n                orderBy: [values.orderBy],\n            }\n\n            const event = values.events[0]\n\n            if (event) {\n                params.after = event.timestamp || event.event.timestamp\n            }\n\n            const events = await api.get(`${props.apiUrl || 'api/event/'}?${toParams(params)}`)\n            breakpoint()\n\n            if (props.live) {\n                actions.prependNewEvents(events.results)\n            } else {\n                actions.pollEventsSuccess(events.results)\n            }\n\n            actions.setPollTimeout(setTimeout(actions.pollEvents, POLL_TIMEOUT))\n        },\n    }),\n})\n","import React from 'react'\nimport { combineUrl } from 'kea-router'\nimport PropTypes from 'prop-types'\n\nimport { Property } from 'lib/components/Property'\nimport { Link } from 'lib/components/Link'\n\nexport function FilterPropertyLink({ property, value, filters, onClick }) {\n    const { url } = combineUrl(window.location.pathname, {\n        ...filters,\n        properties: { ...filters.properties, [property]: value },\n    })\n\n    return (\n        <Link\n            to={url}\n            onClick={event => {\n                if (onClick) {\n                    onClick(property, value)\n                }\n            }}\n        >\n            <Property value={value} />\n        </Link>\n    )\n}\nFilterPropertyLink.propTypes = {\n    property: PropTypes.string.isRequired,\n    value: PropTypes.string,\n    filters: PropTypes.object.isRequired,\n    onClick: PropTypes.func,\n}\n","import React from 'react'\n\nfunction indent(n) {\n    return Array(n)\n        .fill('')\n        .map((_, i) => <span key={i}>&nbsp;&nbsp;&nbsp;&nbsp;</span>)\n}\n\nexport function EventElements({ event }) {\n    const elements = [...event.elements].reverse()\n\n    return (\n        <div>\n            {elements.map((element, index) => (\n                <pre\n                    className=\"code\"\n                    style={{\n                        margin: 0,\n                        padding: 0,\n                        borderRadius: 0,\n                        ...(index === elements.length - 1 ? { backgroundColor: 'var(--blue)' } : {}),\n                    }}\n                >\n                    {indent(index)}\n                    &lt;{element.tag_name}\n                    {element.attr_id && ' id=\"' + element.attr_id + '\"'}\n                    {Object.entries(element.attributes).map(([key, value]) => (\n                        <span>\n                            {' '}\n                            {key.replace('attr__', '')}=\"{value}\"\n                        </span>\n                    ))}\n                    &gt;{element.text}\n                    {index === elements.length - 1 && <span>&lt;/{element.tag_name}&gt;</span>}\n                </pre>\n            ))}\n            {[...elements]\n                .reverse()\n                .slice(1)\n                .map((element, index) => (\n                    <pre className=\"code\" key={index} style={{ margin: 0, padding: 0, borderRadius: 0 }}>\n                        {indent(elements.length - index - 2)}\n                        &lt;/{element.tag_name}&gt;\n                    </pre>\n                ))}\n        </div>\n    )\n}\n","import React, { useState } from 'react'\nimport { PropertiesTable } from 'lib/components/PropertiesTable'\nimport moment from 'moment'\nimport { EventElements } from 'scenes/events/EventElements'\n\nexport function EventDetails({ event }) {\n    const [selected, setSelected] = useState('properties')\n\n    return (\n        <div className=\"row\">\n            <div className=\"col-2\">\n                <div className=\"nav flex-column nav-pills\" id=\"v-pills-tab\" role=\"tablist\" aria-orientation=\"vertical\">\n                    <a\n                        className={'cursor-pointer nav-link ' + (selected === 'properties' && 'active')}\n                        onClick={() => setSelected('properties')}\n                    >\n                        Properties\n                    </a>\n                    {event.elements.length > 0 && (\n                        <a\n                            className={'cursor-pointer nav-link ' + (selected === 'elements' && 'active')}\n                            onClick={() => setSelected('elements')}\n                        >\n                            Elements\n                        </a>\n                    )}\n                </div>\n            </div>\n            <div className=\"col-10\">\n                {selected === 'properties' ? (\n                    <div className=\"d-flex flex-wrap flex-column\" style={{ maxWidth: '100%', overflow: 'scroll' }}>\n                        <PropertiesTable\n                            properties={{\n                                Timestamp: moment(event.timestamp).toISOString(),\n                                ...event.properties,\n                            }}\n                        />\n                    </div>\n                ) : (\n                    <EventElements event={event} />\n                )}\n            </div>\n        </div>\n    )\n}\n","import React from 'react'\nimport moment from 'moment'\nimport { FilterPropertyLink } from 'lib/components/FilterPropertyLink'\nimport { Property } from 'lib/components/Property'\nimport { Link } from 'lib/components/Link'\n\nconst eventNameMap = event => {\n    if (event.properties.$event_type === 'click') return 'clicked '\n    if (event.properties.$event_type === 'change') return 'typed something into '\n    if (event.properties.$event_type === 'submit') return 'submitted '\n    return event.event\n}\n\nexport function EventRow({\n    event,\n    highlightEvents,\n    selectedEvent,\n    properties,\n    search,\n    setSelectedEvent,\n    filtersEnabled,\n    showLinkToPerson,\n}) {\n    let params = ['$current_url', '$lib']\n    return (\n        <tr\n            className={'cursor-pointer event-row ' + (highlightEvents[event.id] && 'event-row-new')}\n            onClick={() => setSelectedEvent(selectedEvent !== event.id ? event.id : false)}\n        >\n            <td>\n                {eventNameMap(event)}\n                {event.elements.length > 0 && (\n                    <pre style={{ marginBottom: 0, display: 'inline' }}>&lt;{event.elements[0].tag_name}&gt;</pre>\n                )}\n                {event.elements.length > 0 && event.elements[0].text && ' with text \"' + event.elements[0].text + '\"'}\n            </td>\n            <td>\n                {showLinkToPerson ? (\n                    <Link to={`/person/${encodeURIComponent(event.distinct_id)}${search}`} className=\"ph-no-capture\">\n                        {event.person}\n                    </Link>\n                ) : (\n                    event.person\n                )}\n            </td>\n            {params.map(paramRequest => {\n                let param = paramRequest\n                let value = event.properties[param]\n\n                if (param === '$current_url' && !value) {\n                    param = '$screen'\n                    value = event.properties[param]\n                }\n\n                return (\n                    <td key={param} title={value}>\n                        {filtersEnabled ? (\n                            <FilterPropertyLink\n                                property={param}\n                                value={event.properties[param]}\n                                filters={{ properties }}\n                            />\n                        ) : (\n                            <Property value={event.properties[param]} />\n                        )}\n                    </td>\n                )\n            })}\n            <td>{moment(event.timestamp).fromNow()}</td>\n        </tr>\n    )\n}\n","import { Link } from 'lib/components/Link'\nimport React from 'react'\n\nexport function NoItems() {\n    return (\n        <tr>\n            <td colSpan={4}>\n                You don't have any items here. If you haven't integrated PostHog yet,{' '}\n                <Link to=\"/setup\">click here to set PostHog up on your app</Link>\n            </td>\n        </tr>\n    )\n}\n","import React from 'react'\nimport { useActions, useValues } from 'kea'\nimport moment from 'moment'\n\nimport { TableRowLoading } from 'lib/utils'\nimport { PropertyFilters } from 'lib/components/PropertyFilters/PropertyFilters'\n\nimport { EventDetails } from 'scenes/events/EventDetails'\nimport { EventRow } from 'scenes/events/EventRow'\nimport { NoItems } from 'scenes/events/NoItems'\nimport { eventsTableLogic } from 'scenes/events/eventsTableLogic'\nimport { Spin } from 'antd'\nimport { router } from 'kea-router'\n\nexport function EventsTable({ fixedFilters, filtersEnabled = true }) {\n    const logic = eventsTableLogic({ fixedFilters })\n    const {\n        properties,\n        events,\n        isLoading,\n        hasNext,\n        isLoadingNext,\n        selectedEvent,\n        newEvents,\n        highlightEvents,\n    } = useValues(logic)\n    const { updateProperty, setSelectedEvent, fetchNextEvents, flipSort, prependNewEvents } = useActions(logic)\n    const {\n        location: { search },\n    } = useValues(router)\n\n    const showLinkToPerson = !fixedFilters?.person_id\n\n    return (\n        <div className=\"events\">\n            {filtersEnabled ? <PropertyFilters pageKey=\"EventsTable\" /> : null}\n            <table className=\"table\" style={{ position: 'relative' }}>\n                <thead>\n                    <tr>\n                        <th>Event</th>\n                        <th>Person</th>\n                        <th>Path / Screen</th>\n                        <th>Source</th>\n                        <th onClick={flipSort}>\n                            When <i className=\"fi flaticon-sort\" />\n                        </th>\n                    </tr>\n                </thead>\n                <tbody>\n                    {isLoading && <TableRowLoading colSpan={5} asOverlay={events.length > 0} />}\n                    <tr\n                        className={'event-new-events ' + (newEvents.length > 0 ? 'show' : 'hide')}\n                        onClick={() => prependNewEvents(newEvents)}\n                    >\n                        <td colSpan=\"5\">\n                            <div>There are {newEvents.length} new events. Click here to load them.</div>\n                        </td>\n                    </tr>\n                    {!events || events.length === 0 ? <NoItems /> : null}\n                    {events &&\n                        events.map((event, index) => (\n                            <React.Fragment key={event.id}>\n                                {index > 0 && !moment(event.timestamp).isSame(events[index - 1].timestamp, 'day') && (\n                                    <tr>\n                                        <td colSpan=\"5\" className=\"event-day-separator\">\n                                            {moment(event.timestamp).format('LL')}\n                                        </td>\n                                    </tr>\n                                )}\n                                <EventRow\n                                    event={event}\n                                    search={search}\n                                    highlightEvents={highlightEvents}\n                                    selectedEvent={selectedEvent}\n                                    properties={properties}\n                                    setSelectedEvent={setSelectedEvent}\n                                    setFilter={updateProperty}\n                                    filtersEnabled={filtersEnabled}\n                                    showLinkToPerson={showLinkToPerson}\n                                />\n                                {selectedEvent === event.id && (\n                                    <tr>\n                                        <td colSpan=\"5\">\n                                            <EventDetails event={event} />\n                                        </td>\n                                    </tr>\n                                )}\n                            </React.Fragment>\n                        ))}\n                </tbody>\n            </table>\n            <div\n                style={{\n                    visibility: hasNext || isLoadingNext ? 'visible' : 'hidden',\n                    margin: '2rem auto 5rem',\n                    textAlign: 'center',\n                }}\n            >\n                <button className=\"btn btn-primary\" onClick={fetchNextEvents}>\n                    {isLoadingNext ? <Spin /> : 'Load more events'}\n                </button>\n            </div>\n            <div style={{ marginTop: '5rem' }} />\n        </div>\n    )\n}\n","import React, { useEffect, useState } from 'react'\nimport { EventsTable } from '../events/EventsTable'\nimport api from 'lib/api'\nimport { PropertiesTable } from 'lib/components/PropertiesTable'\nimport { deletePersonData } from 'lib/utils'\nimport { Button } from 'antd'\n\nexport function Person({ distinctId, id }) {\n    const [person, setPerson] = useState(null)\n\n    useEffect(() => {\n        let url = ''\n        if (distinctId) {\n            url = `api/person/by_distinct_id/?distinct_id=${distinctId}`\n        } else {\n            url = `api/person/${id}`\n        }\n        api.get(url).then(setPerson)\n    }, [distinctId, id])\n\n    return person ? (\n        <div>\n            <Button\n                className=\"float-right\"\n                danger\n                onClick={() => deletePersonData(person, () => history.push('/people'))}\n            >\n                Delete all data on this person\n            </Button>\n            <h1>{person.name}</h1>\n            <div style={{ maxWidth: 750 }}>\n                <PropertiesTable properties={person.properties} />\n                <table className=\"table\">\n                    <tbody>\n                        <tr>\n                            <td>Distinct IDs</td>\n                            <td>\n                                {person.distinct_ids.map(distinct_id => (\n                                    <pre style={{ margin: 0 }} key={distinct_id}>\n                                        {distinct_id}\n                                    </pre>\n                                ))}\n                            </td>\n                        </tr>\n                    </tbody>\n                </table>\n            </div>\n            <EventsTable fixedFilters={{ person_id: person.id }} />\n        </div>\n    ) : null\n}\n"],"sourceRoot":""}