{"version":3,"sources":["webpack:///./frontend/src/lib/utils.js","webpack:///./frontend/src/lib/components/PropertyFilters/PropertyValue.js","webpack:///./frontend/src/lib/components/PropertyFilters/PropertyFilter.js","webpack:///./frontend/src/lib/components/PropertyFilters/propertyFilterLogic.js","webpack:///./frontend/src/lib/components/PropertyFilters/PropertyFilters.js","webpack:///./frontend/src/lib/components/PropertiesTable.js"],"names":["uuid","replace","c","crypto","getRandomValues","Uint8Array","toString","toParams","obj","Object","entries","filter","map","key","val","_isAMomentObject","encodeURIComponent","format","JSON","stringify","handleVal","join","fromParams","window","location","search","slice","split","reduce","a","b","decodeURIComponent","percentage","division","toLocaleString","undefined","style","maximumFractionDigits","Loading","className","TableRowLoading","colSpan","asOverlay","padding","textAlign","CloseButton","props","aria-hidden","Card","title","children","DeleteWithUndo","href","onClick","e","preventDefault","deleteWithUndo","undo","api","update","endpoint","object","id","deleted","then","callback","response","name","toast","toastId","propTypes","PropTypes","string","isRequired","shape","number","selectStyle","control","base","height","minHeight","indicatorsContainer","input","paddingBottom","paddingTop","margin","opacity","valueContainer","marginTop","option","debounce","func","wait","immediate","timeout","context","this","args","arguments","later","apply","callNow","clearTimeout","setTimeout","capitalizeFirstLetter","charAt","toUpperCase","operatorMap","exact","is_not","icontains","not_icontains","gt","lt","operatorEntries","reverse","formatFilterName","str","value","includes","deletePersonData","person","confirm","objectsEqual","obj1","obj2","PropertyValue","state","loadPropertyValues","bind","ref","React","createRef","propertyKey","get","propValues","property","label","onSet","isEditing","loadOptions","defaultOptions","cacheOptions","formatCreateLabel","inputValue","allowCreateWhileLoading","createOptionPosition","placeholder","width","onChange","out","setState","select","blur","autoFocus","styles","onFocus","onInputChange","actionMeta","action","Component","any","operatorOptions","PropertyFilter","index","onComplete","logic","useValues","properties","filters","useActions","setFilter","item","remove","keys","values","minWidth","options","isLoading","openMenuOnFocus","operator","isNaN","propertyFilterLogic","kea","pageKey","actions","loadEventProperties","setProperties","setFilters","newFilter","loaders","loadPeopleProperties","reducers","loadPeoplePropertiesSuccess","_","propertyFilters","newFilters","newState","i","length","listeners","dict","result","router","searchParams","pathname","f","push","urlToAction","error","mappedFilters","events","afterMount","userLogic","eventProperties","FilterRow","useState","open","setOpen","align","trigger","onVisibleChange","visible","defaultVisible","placement","content","type","maxWidth","overflow","textOverflow","cursor","float","PropertyFilters","marginBottom","display","PropertiesTable","Array","isArray","sort"],"mappings":"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","file":"action~events~liveActions~people~person.js","sourcesContent":["import React from 'react'\nimport api from './api'\nimport { toast } from 'react-toastify'\nimport PropTypes from 'prop-types'\nimport { Spin } from 'antd'\n\nexport function uuid() {\n    return ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, c =>\n        (c ^ (crypto.getRandomValues(new Uint8Array(1))[0] & (15 >> (c / 4)))).toString(16)\n    )\n}\n\nexport let toParams = obj => {\n    let handleVal = val => {\n        if (val._isAMomentObject) return encodeURIComponent(val.format('YYYY-MM-DD'))\n        val = typeof val === 'object' ? JSON.stringify(val) : val\n        return encodeURIComponent(val)\n    }\n    return Object.entries(obj)\n        .filter(([key, val]) => val)\n        .map(([key, val]) => `${key}=${handleVal(val)}`)\n        .join('&')\n}\nexport let fromParams = () =>\n    window.location.search != ''\n        ? window.location.search\n              .slice(1)\n              .split('&')\n              .reduce((a, b) => {\n                  b = b.split('=')\n                  a[b[0]] = decodeURIComponent(b[1])\n                  return a\n              }, {})\n        : {}\n\nexport let colors = ['success', 'secondary', 'warning', 'primary', 'danger', 'info', 'dark', 'light']\nexport let percentage = division =>\n    division\n        ? division.toLocaleString(undefined, {\n              style: 'percent',\n              maximumFractionDigits: 2,\n          })\n        : ''\n\nexport let Loading = () => (\n    <div className=\"loading-overlay\">\n        <div></div>\n        <Spin />\n    </div>\n)\n\nexport const TableRowLoading = ({ colSpan = 1, asOverlay = false }) => (\n    <tr className={asOverlay ? 'loading-overlay over-table' : ''}>\n        <td colSpan={colSpan} style={{ padding: 50, textAlign: 'center' }}>\n            <Spin />\n        </td>\n    </tr>\n)\n\nexport let CloseButton = props => {\n    return (\n        <span {...props} className={'close cursor-pointer ' + props.className} style={{ ...props.style }}>\n            <span aria-hidden=\"true\">&times;</span>\n        </span>\n    )\n}\n\nexport function Card(props) {\n    return (\n        <div {...props} className={'card ' + props.className} style={props.style} title=\"\">\n            {props.title && <div className=\"card-header\">{props.title}</div>}\n            {props.children}\n        </div>\n    )\n}\n\nexport let DeleteWithUndo = props => {\n    let deleteWithUndo = undo => {\n        api.update('api/' + props.endpoint + '/' + props.object.id, {\n            ...props.object,\n            deleted: undo ? false : true,\n        }).then(() => {\n            props.callback()\n            let response = (\n                <div>\n                    {!undo ? (\n                        <span>\n                            \"<strong>{props.object.name}</strong>\" deleted.{' '}\n                            <a\n                                href=\"#\"\n                                onClick={e => {\n                                    e.preventDefault()\n                                    deleteWithUndo(true)\n                                }}\n                            >\n                                Click here to undo\n                            </a>\n                        </span>\n                    ) : (\n                        <span>Delete un-done</span>\n                    )}\n                </div>\n            )\n            toast(response, { toastId: 'delete-item-' + props.object.id })\n        })\n    }\n\n    return (\n        <a\n            href=\"#\"\n            onClick={e => {\n                e.preventDefault()\n                deleteWithUndo()\n            }}\n            className={props.className}\n            style={props.style}\n        >\n            {props.children}\n        </a>\n    )\n}\nDeleteWithUndo.propTypes = {\n    endpoint: PropTypes.string.isRequired,\n    object: PropTypes.shape({\n        name: PropTypes.string.isRequired,\n        id: PropTypes.number.isRequired,\n    }).isRequired,\n    className: PropTypes.string,\n    style: PropTypes.object,\n}\n\nexport let selectStyle = {\n    control: base => ({\n        ...base,\n        height: 31,\n        minHeight: 31,\n    }),\n    indicatorsContainer: base => ({\n        ...base,\n        height: 31,\n    }),\n    input: base => ({\n        ...base,\n        paddingBottom: 0,\n        paddingTop: 0,\n        margin: 0,\n        opacity: 1,\n    }),\n    valueContainer: base => ({\n        ...base,\n        padding: '0 8px',\n        marginTop: -2,\n    }),\n    option: base => ({\n        ...base,\n        padding: '2px 15px',\n    }),\n}\n\nexport let debounce = (func, wait, immediate) => {\n    var timeout\n    return function() {\n        var context = this,\n            args = arguments\n        var later = function() {\n            timeout = null\n            if (!immediate) func.apply(context, args)\n        }\n        var callNow = immediate && !timeout\n        clearTimeout(timeout)\n        timeout = setTimeout(later, wait)\n        if (callNow) func.apply(context, args)\n    }\n}\n\nexport const capitalizeFirstLetter = string => {\n    return string.charAt(0).toUpperCase() + string.slice(1)\n}\n\nexport const operatorMap = {\n    exact: '= equals',\n    is_not: \"≠ doesn't equal\",\n    icontains: '∋ contains',\n    not_icontains: \"∌ doesn't contain\",\n    gt: '> greater than',\n    lt: '< lower than',\n}\n\nconst operatorEntries = Object.entries(operatorMap).reverse()\n\nexport const formatFilterName = str => {\n    for (let [key, value] of operatorEntries) {\n        if (str.includes(key)) return str.replace('__' + key, '') + ` ${value.split(' ')[0]} `\n    }\n    return str + ` ${operatorMap['exact'].split(' ')[0]} `\n}\n\nexport const deletePersonData = (person, callback) => {\n    window.confirm('Are you sure you want to delete this user? This cannot be undone') &&\n        api.delete('api/person/' + person.id).then(() => {\n            toast('Person succesfully deleted.')\n            if (callback) callback()\n        })\n}\n\nexport const objectsEqual = (obj1, obj2) => JSON.stringify(obj1) === JSON.stringify(obj2)\n","import React, { Component } from 'react'\nimport api from '../../api'\nimport AsyncCreatableSelect from 'react-select/async-creatable/dist/react-select.esm'\nimport { selectStyle, debounce } from '../../utils'\nimport PropTypes from 'prop-types'\n\nexport class PropertyValue extends Component {\n    constructor(props) {\n        super(props)\n        this.state = { input: props.value }\n        this.loadPropertyValues = debounce(this.loadPropertyValues.bind(this), 250)\n        this.ref = React.createRef()\n    }\n    loadPropertyValues(value, callback) {\n        let key = this.props.propertyKey.split('__')[0]\n        api.get('api/' + this.props.endpoint + '/values/?key=' + key + (value ? '&value=' + value : '')).then(\n            propValues =>\n                callback(\n                    propValues.map(property => ({\n                        label: property.name ? property.name : '(empty)',\n                        value: property.name,\n                    }))\n                )\n        )\n    }\n    render() {\n        let { propertyKey, onSet, value } = this.props\n        let { isEditing, input } = this.state\n        return (\n            <span ref={this.ref} className=\"property-value\">\n                <AsyncCreatableSelect\n                    loadOptions={this.loadPropertyValues}\n                    defaultOptions={true}\n                    cacheOptions\n                    formatCreateLabel={inputValue => 'Specify: ' + inputValue}\n                    allowCreateWhileLoading={true}\n                    createOptionPosition=\"first\"\n                    key={propertyKey} // forces a reload of the component when the property changes\n                    placeholder=\"Property value\"\n                    style={{ width: 200 }}\n                    value={{ label: value, value: value }}\n                    onChange={out => {\n                        onSet(propertyKey, out.value)\n                        this.setState({ input: out.value })\n                        this.select.blur()\n                    }}\n                    autoFocus={!value}\n                    styles={selectStyle}\n                    ref={ref => {\n                        this.select = ref\n                    }}\n                    // This is a series of hacks to make the text editable\n                    inputValue={isEditing ? this.state.input : ''}\n                    onFocus={() => this.setState({ isEditing: true })}\n                    onInputChange={(input, actionMeta) => {\n                        if (actionMeta.action === 'input-change') {\n                            this.setState({ input })\n                            return input\n                        }\n                        return this.state.input\n                    }}\n                />\n            </span>\n        )\n    }\n}\nPropertyValue.propTypes = {\n    propertyKey: PropTypes.string.isRequired,\n    value: PropTypes.any.isRequired,\n    onSet: PropTypes.func.isRequired,\n}\n","import React from 'react'\nimport Select from 'react-select'\nimport { selectStyle, operatorMap } from 'lib/utils'\nimport { PropertyValue } from './PropertyValue'\nimport { useValues, useActions } from 'kea'\n\nconst operatorOptions = Object.entries(operatorMap).map(([key, value]) => ({\n    label: value,\n    value: key,\n}))\n\nexport function PropertyFilter({ index, endpoint, onComplete, logic }) {\n    const { properties, filters } = useValues(logic)\n    const { setFilter, remove } = useActions(logic)\n    let item = filters[index]\n    let key = Object.keys(item)[0] ? Object.keys(item)[0].split('__') : []\n    let value = Object.values(item)[0]\n    return (\n        <div className=\"row\" style={{ margin: '0.5rem -15px', minWidth: key[0] ? 700 : 200 }}>\n            {properties && (\n                <div className={key[0] ? 'col-4' : 'col'}>\n                    <Select\n                        options={properties}\n                        value={[{ label: key[0], value: key[0] }]}\n                        isLoading={!properties}\n                        placeholder=\"Property key\"\n                        onChange={item =>\n                            setFilter(\n                                index,\n                                item.value + (key[1] ? '__' + key[1] : ''),\n                                item.value !== key[0] ? '' : value\n                            )\n                        }\n                        styles={selectStyle}\n                        autoFocus={!key[0]}\n                        openMenuOnFocus={true}\n                    />\n                </div>\n            )}\n\n            {key[0] && (\n                <div className=\"col-3 pl-0\">\n                    <Select\n                        options={operatorOptions}\n                        style={{ width: 200 }}\n                        value={[\n                            {\n                                label: operatorMap[key[1]] || '= equals',\n                                value: key[1],\n                            },\n                        ]}\n                        placeholder=\"Property key\"\n                        onChange={operator => setFilter(index, key[0] + '__' + operator.value, value)}\n                        styles={selectStyle}\n                    />\n                </div>\n            )}\n            {key[0] && (\n                <div className=\"col-5 pl-0\">\n                    <PropertyValue\n                        endpoint={endpoint}\n                        key={Object.keys(item)[0]}\n                        propertyKey={Object.keys(item)[0]}\n                        value={value}\n                        onSet={(key, value) => {\n                            onComplete()\n                            setFilter(index, key, value)\n                        }}\n                    />\n                    {(key[1] === 'gt' || key[1] === 'lt') && isNaN(value) && (\n                        <p className=\"text-danger\">Value needs to be a number. Try \"equals\" or \"contains\" instead.</p>\n                    )}\n                </div>\n            )}\n        </div>\n    )\n}\n","import { kea } from 'kea'\nimport api from '../../../lib/api'\nimport { userLogic } from 'scenes/userLogic'\nimport { objectsEqual } from 'lib/utils'\nimport { router } from 'kea-router'\n\nexport const propertyFilterLogic = kea({\n    key: props => props.pageKey,\n\n    actions: () => ({\n        loadEventProperties: true,\n        setProperties: properties => ({ properties }),\n        update: filters => ({ filters }),\n        setFilter: (index, key, value) => ({ index, key, value }),\n        setFilters: filters => ({ filters }),\n        newFilter: true,\n        remove: index => ({ index }),\n    }),\n\n    loaders: () => ({\n        properties: {\n            loadPeopleProperties: async () => {\n                return (await api.get('api/person/properties')).map(property => ({\n                    label: property.name,\n                    value: property.name,\n                }))\n            },\n        },\n    }),\n\n    reducers: ({ actions, props }) => ({\n        properties: [\n            [],\n            {\n                [actions.loadPeoplePropertiesSuccess]: (_, { properties }) => properties,\n                [actions.setProperties]: (_, { properties }) => properties,\n            },\n        ],\n        filters: [\n            props.propertyFilters\n                ? Object.entries(props.propertyFilters).map(([key, value]) => ({ [key]: value }))\n                : [],\n            {\n                [actions.setFilter]: (state, { index, key, value }) => {\n                    const newFilters = [...state]\n                    newFilters[index] = { [key]: value }\n                    return newFilters\n                },\n                [actions.setFilters]: (_, { filters }) => filters,\n                [actions.newFilter]: state => {\n                    return [...state, {}]\n                },\n                [actions.remove]: (state, { index }) => {\n                    const newState = state.filter((_, i) => i !== index)\n                    if (newState.length === 0) {\n                        return [{}]\n                    }\n                    if (Object.keys(newState[newState.length - 1]).length !== 0) {\n                        return [...newState, {}]\n                    }\n                    return newState\n                },\n            },\n        ],\n    }),\n\n    listeners: ({ actions, props, values }) => ({\n        // Only send update if value is set to something\n        [actions.setFilter]: ({ value }) => value && actions.update(),\n        [actions.remove]: () => actions.update(),\n        [actions.update]: () => {\n            if (props.onChange) {\n                if (values.filters.length === 0) {\n                    actions.newFilter()\n                    return props.onChange({})\n                }\n                if (Object.keys(values.filters[values.filters.length - 1]).length !== 0) actions.newFilter()\n                let dict = values.filters.reduce((result, item) => ({ ...result, ...item }))\n                props.onChange(dict)\n            } else {\n                const { filters } = values\n                const { properties: _, ...searchParams } = router.values.searchParams\n                const { pathname } = router.values.location\n\n                if (filters.filter(f => Object.keys(f).length > 0).length > 0) {\n                    searchParams.properties = filters.reduce((result, item) => ({ ...result, ...item }))\n                }\n\n                if (!objectsEqual(router.values.searchParams, searchParams)) {\n                    router.actions.push(pathname, searchParams)\n                }\n            }\n        },\n    }),\n\n    urlToAction: ({ actions, values, props }) => ({\n        '*': (_, { properties }) => {\n            if (props.onChange) {\n                return\n            }\n\n            let filters\n            try {\n                filters = values.filters\n            } catch (error) {\n                // since this is a catch-all route, this code might run during or after the logic was unmounted\n                // if we have an error accessing the filter value, the logic is gone and we should return\n                return\n            }\n\n            if (!objectsEqual(properties || {}, filters)) {\n                const mappedFilters = Object.entries(properties || {}).map(([key, value]) => ({ [key]: value }))\n                actions.setFilters([...mappedFilters, {}])\n            }\n        },\n    }),\n\n    events: ({ actions, props }) => ({\n        afterMount: () => {\n            actions.newFilter()\n            if (props.endpoint === 'person') {\n                actions.loadPeopleProperties()\n            } else {\n                actions.setProperties(userLogic.values.eventProperties)\n            }\n        },\n    }),\n})\n","import React, { useState } from 'react'\nimport { PropertyFilter } from './PropertyFilter'\nimport { Button } from 'antd'\nimport { useValues, useActions } from 'kea'\nimport { propertyFilterLogic } from './propertyFilterLogic'\nimport { Popover, Row } from 'antd'\nimport { CloseButton, formatFilterName } from 'lib/utils'\n\nfunction FilterRow({ endpoint, item, index, filters, logic }) {\n    const { remove } = useActions(logic)\n    let [open, setOpen] = useState(false)\n\n    let handleVisibleChange = visible => {\n        if (!visible && Object.keys(item).length >= 0 && !item[Object.keys(item)[0]]) {\n            remove(index)\n        }\n        setOpen(visible)\n    }\n\n    return (\n        <Row align=\"middle\" className=\"mt-2 mb-2\">\n            <Popover\n                trigger=\"click\"\n                onVisibleChange={handleVisibleChange}\n                defaultVisible={false}\n                visible={open}\n                placement=\"bottomLeft\"\n                content={\n                    <PropertyFilter\n                        key={index}\n                        index={index}\n                        endpoint={endpoint || 'event'}\n                        onComplete={() => setOpen(false)}\n                        logic={logic}\n                    />\n                }\n            >\n                {Object.keys(item).length !== 0 ? (\n                    <Button type=\"primary\" shape=\"round\" style={{ maxWidth: '85%' }}>\n                        <span style={{ width: '100%', overflow: 'hidden', textOverflow: 'ellipsis' }}>\n                            {formatFilterName(Object.keys(item)[0]) + item[Object.keys(item)[0]]}\n                        </span>\n                    </Button>\n                ) : (\n                    <Button type=\"default\" shape=\"round\">\n                        {'New Filter'}\n                    </Button>\n                )}\n            </Popover>\n            {index !== filters.length - 1 && (\n                <CloseButton\n                    className=\"ml-1\"\n                    onClick={() => {\n                        remove(index)\n                    }}\n                    style={{ cursor: 'pointer', float: 'none' }}\n                />\n            )}\n        </Row>\n    )\n}\n\nexport function PropertyFilters({ endpoint, propertyFilters, className, style, onChange, pageKey }) {\n    const logic = propertyFilterLogic({ propertyFilters, endpoint, onChange, pageKey })\n    const { filters } = useValues(logic)\n\n    return (\n        <div\n            className={className || 'col-8'}\n            style={{\n                padding: 0,\n                marginBottom: '2rem',\n                display: 'inline',\n                style,\n            }}\n        >\n            <div className=\"column\">\n                {filters &&\n                    filters.map((item, index) => {\n                        return (\n                            <FilterRow\n                                key={index === filters.length - 1 ? index : `${index}_${Object.keys(item)[0]}`}\n                                logic={logic}\n                                item={item}\n                                index={index}\n                                filters={filters}\n                                endpoint={endpoint}\n                            />\n                        )\n                    })}\n            </div>\n        </div>\n    )\n}\n","import React, { Component } from 'react'\nimport PropTypes from 'prop-types'\n\nexport function PropertiesTable({ properties }) {\n    if (Array.isArray(properties))\n        return (\n            <div>\n                {properties.map((item, index) => (\n                    <span key={index}>\n                        <PropertiesTable properties={item} />\n                        <br />\n                    </span>\n                ))}\n            </div>\n        )\n    if (properties instanceof Object)\n        return (\n            <table className=\"table\">\n                <tbody>\n                    {Object.keys(properties)\n                        .sort()\n                        .map(key => (\n                            <tr key={key}>\n                                <th>{key}</th>\n                                <td>\n                                    <PropertiesTable properties={properties[key]} />\n                                </td>\n                            </tr>\n                        ))}\n                </tbody>\n            </table>\n        )\n    if (properties === true) return 'true'\n    if (properties === false) return 'false'\n    return properties ? properties : null\n}\nPropertiesTable.propTypes = {\n    properties: PropTypes.any.isRequired,\n}\n"],"sourceRoot":""}